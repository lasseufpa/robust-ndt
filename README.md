# Towards a Robust Transport Network With Self-adaptive Network Digital Twin
ArXiv link: https://arxiv.org/abs/2507.20971

## Introduction
The ability of the network digital twin (NDT) to remain aware of changes in its physical counterpart, known as the physical twin (PTwin), is a fundamental condition to enable timely synchronization, also referred to as twinning. In this way, considering a transport network, a key requirement is to handle unexpected traffic variability and dynamically adapt to maintain optimal performance in the associated virtual model, known as the virtual twin (VTwin).In this context, we propose a self-adaptive implementation of a novel NDT architecture designed to provide accurate delay predictions, even under fluctuating traffic conditions. This architecture addresses an essential challenge, underexplored in the literature: improving the resilience of data-driven NDT platforms against traffic variability and improving synchronization between the VTwin and its physical counterpart. 

## Repository directory structure
```bash
├── ndt
│   ├── alone_training
│   └── sync
│       ├── database
│       ├── database_for_app
│       ├── misc
│       └── results
└── traffic_generator
    └── topologies
```

## Getting started
To install the python environment used to conduct the experiments, use the following command:
### Install conda environment
```bash
conda env create -f environment.yml
```


Once the environment installed, you need to instatiate a container with the SDN controller (ONOS). It is necessary only if you would like to generate traffic datasets:

### Instantiate ONOS docker container
```
sudo docker compose up -d
```

## Data generation
The data generation is process that starts with the generation of the raw dataset using the D-ITG simulator using `generate_traffic.py`. However, this data generated, at this stage, is not suitable for training a deep learning model (VTwin). So, we need to extract all features available using `generate_metrics.py` script, to finally generate Tensorflow-like data, using `generate_data.py` script, to be used by the VTwin model. 

### Generate raw network traffic data with D-ITG
Flags:

`--topo-filepath`: Path to `.gml` topology.

`id`: Simple simulation index.
```bash
sudo mn -c && sudo $(which python) generate_traffic.py --id 1 --topo-filepath topology/nsfnet_14.gml
```

:warning: The dataset generated from this command can consume to much space. Ensure you have enough space for large simulations.

:information_source: If you prefer to use the raw dataset generated for this work, you can access it by the following link:

The table below describe the characteristics of the datasets generated.

| # | Traffic pattern | Topology      | Number of flows (T) |
|---|------------------|---------------|---------------------|
|   |                  | 5G-Crosshaul  | 121,400             |
| 1 |Exponential       | Germany       | 129,600             |
|   |                  | PASSION       | 129,600             |
|   |                  | 5G-Crosshaul  | 234,501             |
| 2 | Poisson          | Germany       | 257,401             |
|   |                  | PASSION       | 243,001             |
|   |                  | 5G-Crosshaul  | 347,002             |
| 3 | Uniform          | Germany       | 378,802             |
|   |                  | PASSION       | 355,002             |
|   |                  | 5G-Crosshaul  | 447,803             |
| 4 |Deterministic     | Germany       | 440,003             |
|   |                  | PASSION       | 478,203             |

### Generate metrics from network traffic dataset
Once a network traffic is generated by the D-ITG simulator, you need to process the logs files generated. To do so, you can use the script `generate_metrics.py` for this task. This script will retrieve metrics such as `average traffic rate`, `delay`, `jitter` and `packet loss`.

Flags:

`--dir`: Path to network traffic log directory.


```bash
sudo generate_metrics.py --dir experiments_100
```

### Generate data to VTwin model
Finally, once the metrics were processed, you can generate data, typically input-output format to be used by the VTwin (GNN) model.

Flags:

`--input-dir`: Path to processed metrics

`--output-dir`: Path to output dataset

```bash
python3 generate_data.py --input-dir [path-to-processed-dir] --output-dir [path-to-output-dir]
```

## NDT operation

To run a transport network NDT, you can use standlone script from `alone_training`, which there is no synchronization elements, or the scripts in `sync` directory with synchronization elements.

### NDT with synchronization
To generate the results, you can run the `ndt_synchronization.py` script:

Flags:

`--topology`: Topology to be adopted in the NDT simulations.

`--database`: Path to retraining data.

`--realization`: Number of independent realization to used in the simulations.

`--sync`: Flag to enable NDT synchronization.

`--target`: Type of QoS to be predicted.

```bash
python3 ndt_synchronization.py --topology 5g_crosshaul --dir delay_database --realization 10 --sync --target delay 
```

### Application for SLA monitoring

## Generate result plots:
Several scripts are available in the `misc` directory, that can be used to replicate the results used in this work. Below, there is a short description of each one.

`concept_drift_op_plot.py`:

`get_nmse_metrics.py`:

`histogram_plot.py`:

`single_plot.py`:

`multiple_plots.py`:

`sla_violations_plot.py`:

`training_time_plot.py`:

`window_size_plot.py`:


In the above example, the transport network NDT will running considering the 5G-Crosshaul, the QoS metric to be predicted will be the per-flow delay, and 10 traininig process realization will be taken.

## Credits

If you benefit from this work, please cite on your publications using:
```
@misc{modesto2025,
      title={Towards a Robust Transport Network With Self-adaptive Network Digital Twin}, 
      author={Cláudio Modesto and João Borges and Cleverson Nahum and Lucas Matni and Cristiano Bonato Both and Kleber Cardoso and Glauco Gonçalves and Ilan Correa and Silvia Lins and Andrey Silva and Aldebaro Klautau},
      year={2025},
      eprint={2507.20971},
      archivePrefix={arXiv},
      primaryClass={cs.NI},
      url={https://arxiv.org/abs/2507.20971}, 
}
```